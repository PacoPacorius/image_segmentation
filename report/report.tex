\documentclass{article} 
\usepackage{polyglossia} 
\usepackage{amsmath}
\usepackage{fontspec} 
\usepackage{lipsum} 
\usepackage[margin=1in]{geometry}
\usepackage{graphicx} 
\usepackage{caption} 
\usepackage{subcaption}
\usepackage{hyperref} 
\usepackage{listing}
\hypersetup{% 
    colorlinks=true, linkcolor=blue, filecolor=magenta,      
    urlcolor=cyan, 
    pdfinfo = {%
        Title = Αναφορά 3ης Εργασίας ΨΕΕ
        Author = {Χρήστος Μάριος Περδίκης},
        Producer = XeLaTeX,
    } 
}

\setmainfont{Nimbus Roman}

\title{Ψηφιακή Επεξεργασία Εικόνας \\ Image Segmentation}
\date{Εαρινό Εξάμηνο 2024-2025}
\author{Χρήστος-Μάριος Περδίκης 10075 cperdikis@ece.auth.gr}

\begin{document}
\maketitle
Σε αυτήν την εργασία υλοποιείται σε python η αναπαράσταση εικόνων σε γράφους και image
segmentation με τις μεθόδους spectral clustering και normalized cuts.


\section{Συνάρτηση img\_to\_graph()}
Η συνάρτηση img\_to\_graph() βρίσκεται στο αρχείο img\_to\_graph.py. Η είσοδός της
είναι το array της εικόνας εισόδου του προγράμματος. Το array της εικόνας 
ανασχηματίζεται έτσι ώστε κάθε γραμμή να αντιστοιχεί σε ένα pixel με C κανάλια.
Αυτό θα απλουστεύσει τις πράξεις. Για τον υπολογισμό των ευκλείδιων αποστάσεων 
μεταξύ των pixel της εικόνας χρησιμοποιείται η συνάρτηση scipy.spatial.distance.cdist()
για λόγους αποδοτικότητας. Έπειτα δημιουργείται ο affinity matrix:

\begin{equation}
    affinity\_mat = \frac{1}{e^{distances}}
\end{equation}
όπου $distances$ το array που περιέχει τις ευκλείδιες αποστάσεις κάθε ζεύγους
pixel στην εικόνα. Τέλος στον πίνακα affinity matrix τοποθετούνται άσσοι στην
διαγώνιό του, για να είναι σίγουρο ότι το ζεύγος ενός pixel με τον εαυτό του
είναι ακριβώς 1 και επιστρέφεται ο πίνακας affinity matrix.

\section{Συνάρτηση spectral\_clustering()}
Η συνάρτηση spectral\_clustering() βρίσκεται στο αρχείο spectral\_clustering().
Η είσοδος της συνάρτησης είναι ένα affinity matrix που περιγράφει τον γράφο μιας
εικόνας και ο ακέραιος k που θα καθορίσει σε πόσα clusters θα χωρίσουμε την εικόνα.
Κατασκευάζεται το degree matrix από το affinity matrix:

\begin{equation}
    D(i, i) \sum_j W(i, j)
\end{equation}
Έπειτα υπολογίζεται ο Λαπλασιανός πίνακας:

\begin{equation}
    L = D - W
\end{equation}

Βρίσκονται οι ιδιοτιμές και τα ιδιοδιανύσματα του Λαπλασιανού πίνακα. Η 
συνάρτηση scipy.sparse.linalg.eigs() καλείται με ορίσματα $k$ και 
$which='SM'$, έτσι ώστε η συνάρτηση να επιστρέψει τις $k$ μικρότερες σε μέτρο
ιδιοτιμές και τα αντίστοιχα ιδιοδιανύσματα. Οι ιδιοτιμές και τα ιδιοδιανύσματα
ταξινομούνται με βάση το μέτρο των ιδιοτιμών. Η συνάρτηση sklearn.cluster.KMeans()
δεν υποστηρίζει φανταστικούς αριθμούς, οπότε ο πίνακας $U$ δημιουργείται με
το πραγματικό μόνο μέρος των ιδιοδιανυσμάτων και μετά πραγματοποιείται k-means 
clustering όπως απαιτεί η εκφώνηση της εργασίας. Το array με τις ετικέτες που 
δείχνουν σε ποιό cluster ανήκουν οι κορυφές του γράφου (δηλαδή κάθε pixel της
εικόνας) είναι η έξοδος της συνάρτησης spectral\_clustering().

\section{Εφαρμογές}
\subsection{demo1} 
\subsection{demo2}
\section{Συνάρτηση n\_cuts()}
\section{Συνάρτηση calculate\_ncut\_value()}
\section{Συνάρτηση n\_cuts\_recursive()}
\section{Εφαρμογές}
\subsection{demo3a} 
\subsection{demo3b}
\subsection{demo3c}
\end{document}
